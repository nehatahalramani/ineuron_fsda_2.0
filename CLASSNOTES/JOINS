USE WAREHOUSE DEMO;
USE DATABASE SQLDEMO;

CREATE OR REPLACE TABLE COW_ONE(CNUMBER_1 INT,BREED VARCHAR(20));

INSERT INTO COW_ONE VALUES(1,'LABRADOG');
INSERT INTO COW_ONE VALUES(2,'HONEY');
INSERT INTO COW_ONE VALUES(3,'ROSY');
INSERT INTO COW_ONE VALUES(4,'SHERRY');
INSERT INTO COW_ONE VALUES(7,'NAN');

SELECT * FROM COW_ONE;

CREATE OR REPLACE TABLE COW_TWO(CNUMBER_2 INT,CBREED VARCHAR(20));

INSERT INTO COW_TWO VALUES(1,'LINDT');
INSERT INTO COW_TWO VALUES(2,'LILU');
INSERT INTO COW_TWO VALUES(3,'NEHA');
INSERT INTO COW_TWO VALUES(6,'NIKS');
INSERT INTO COW_TWO VALUES(7,'RITZ');

SELECT * FROM COW_TWO;

SELECT CW1.CNUMBER_1, CW1.BREED, CW2.CBREED
FROM COW_ONE AS CW1
INNER JOIN COW_TWO AS CW2 ON CW1.CNUMBER_1 = CW2.CNUMBER_2;


SELECT CW2.CNUMBER_2, CW2.CBREED, CW1.BREED
FROM COW_TWO AS CW2
LEFT OUTER JOIN COW_ONE AS CW1 ON CW2.CNUMBER_2 = CW1.CNUMBER_1;


CREATE OR REPLACE TABLE  NT_OWNER
(
   OwnerID INTEGER NOT NULL PRIMARY KEY ,
   Name VARCHAR2(20),
   Surname STRING,
   StreetAddress VARCHAR2(50),
   City STRING,
   State CHAR(4),
   StateFull STRING,
   ZipCode INTEGER
);

//IN THIS FOREIGN KEY THERE THAT MEANS ONE COLUMN NAME WE ARE REFERENCING FROM OTHER TABLE HERE OWNER ID IS FROM NT_OWNERS 
CREATE OR REPLACE TABLE NT_PETS
(
    PetID VARCHAR(10) NOT NULL PRIMARY KEY,
    Name VARCHAR(20),
    Kind STRING,
    Gender CHAR(7),
    Age INTEGER,
    OwnerID INTEGER NOT NULL REFERENCES OWNER  //THIS IS THE SYNTAX OF FOREIGN KEY 
);

SELECT * FROM NT_OWNER;
SELECT COUNT(*) FROM NT_PETS;
SELECT * FROM NT_PETS;
SELECT COUNT(*) FROM NT_OWNER;

--CREATE A MASTER TABLE WHERE NEEDED OWNERS WHICH HAS PETS (INNER JOIN)

CREATE OR REPLACE TABLE NT_OWNER_PETS AS
SELECT NT_OWNER.OWNERID,NT_OWNER.NAME AS OWNER_NAME,SURNAME,CITY,STATE,ZIPCODE,NT_PETS.NAME AS PETS_NAME,KIND,GENDER,AGE,PETID
FROM NT_OWNER
INNER JOIN NT_PETS ON NT_OWNER.OWNERID = NT_PETS.OWNERID;

SELECT * FROM NT_OWNER_PETS;

//LEFT OUTER JOIN
CREATE OR REPLACE TABLE NT_OWNER_PETS AS
SELECT NT_OWNER.OWNERID,NT_OWNER.NAME AS OWNER_NAME,SURNAME,CITY,STATE,ZIPCODE,NT_PETS.NAME AS PETS_NAME,KIND,GENDER,AGE,PETID
FROM NT_PETS
LEFT OUTER JOIN NT_OWNER ON NT_PETS.OWNERID = NT_OWNER.OWNERID;
