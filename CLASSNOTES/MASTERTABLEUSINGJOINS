USE WAREHOUSE DEMO;
USE DATABASE SQLDEMO;

CREATE OR REPLACE TABLE NT_BROKER(
BROKER_ID INTEGER,
BROKER_CODE VARCHAR(40),
BROKER_NAME VARCHAR(50),
DIRTRIBUTION_NETWORK VARCHAR(50),
DISTRIBUTION_CHANNEL VARCHAR(50),
COMMISSION_SCHEME VARCHAR(50)
);

select * from nt_broker;


CREATE OR REPLACE TABLE NT_PRODUCTS(
PRODUCT_ID INTEGER,
PRODUCT_CATEGORY VARCHAR(50),
PRODUCT_SUBCATEGORY VARCHAR(50),
PRODUCT VARCHAR(30));

CREATE OR REPLACE TABLE NT_REGIONS(
REGION_ID INTEGER,
REGION_NAME VARCHAR(40),
COUNTRY VARCHAR2(100),
STATE_CODE STRING,
STATE VARCHAR2(100),
REGION_TYPE VARCHAR(50),
LATITUDE VARCHAR(40),
LONGITUDE VARCHAR(40),
AREA_CODE INTEGER,
POPULATION VARCHAR(30),
HOUSEHOLDS VARCHAR(30),
MEDIAN_INCOME VARCHAR(40),
LAND_AREA VARCHAR(40),
WATER_AREA VARCHAR(40),
TIME_ZONE VARCHAR(50));

SELECT * FROM NT_REGIONS;

CREATE OR REPLACE TABLE NT_CUSTOMERS(
CUSTOMER_ID INTEGER,
CUSTOMER_LASTNAME VARCHAR(30),
CUSTOMER_FIRSTNAME VARCHAR(30),
BIRTHDATE STRING,
GENDER STRING,
PARTICIPANTS_TYPE STRING,
REGIONID INTEGER,
MARITALSTATUS VARCHAR(30));

CREATE OR REPLACE TABLE NT_STATEREGION(
R_STATE_CODE STRING,
R_STATE STRING,
REGION STRING);

SELECT * FROM NT_STATEREGION;

CREATE OR REPLACE TABLE NT_PRIORITIES(
PRIORITIES_ID STRING ,
PRIORITIES_DERSCRIPTION STRING);

CREATE OR REPLACE TABLE NT_STATUSES(
STATUS_ID INTEGER,
STATUS_DESCRIPTION STRING
);

CREATE OR REPLACE TABLE NT_CATEGORIES(
CATEGORIES_ID INTEGER,
CATEGORIES_DESCRIPTION STRING,
CATEGORIES_ACTIVE INTEGER);

CREATE OR REPLACE TABLE NT_SOURCES(
SOURCES_ID STRING,
SOURCES_DESCRIPTION VARCHAR(40));

CREATE OR REPLACE TABLE NT_TYPES(
TYPES_ID INTEGER,
TYPES_DECRIPTION VARCHAR(40));

SELECT * FROM NT_TYPES;

CREATE OR REPLACE TABLE NT_COMPLAINSDATA(
CD_DATA INTEGER,
CD_COMPLAINDATE STRING,
CD_COMPLETIONDATE STRING,
CD_CUSTOMERID INTEGER,
CD_BROKERID INTEGER,
CD_PRODUCTID INTEGER,
CD_COMPLAINPRIORITYID INTEGER,
CD_COMPLAINTYPEID INTEGER,
CD_COMPLAINSOURCEID INTEGER,
COMPLAINCATEGARYID INTEGER,
ComplainStatusID INTEGER, 
AdministratorID string,
ClientSatisfaction VARCHAR(10),
ExpectedReimbursement INTEGER);

select distinct * from NT_COMPLAINSDATA;

CREATE OR REPLACE TABLE NT_STATUS_HISTORY_DATA(
SHD_ID INTEGER,
SHD_ComplaintID INTEGER,
SHD_ComplaintStatusID INTEGER,
SHD_StatusDate DATE);

select * from NT_STATUS_HISTORY_DATA;

CREATE OR REPLACE TABLE NT_MASTER_COMADMINSTRATION AS
SELECT COMP.CD_CUSTOMERID,COMP.CD_COMPLAINDATE,COMP.CD_COMPLETIONDATE,CUST.CUSTOMER_LASTNAME,CUST.CUSTOMER_FIRSTNAME,CUST.GENDER,BR.BROKER_NAME,
BR.COMMISSION_SCHEME,CAT.CATEGORIES_DESCRIPTION,SRG.REGION,STS.STATUS_DESCRIPTION,RG.STATE,PRD.PRODUCT,PR.PRIORITIES_DERSCRIPTION,SRC.SOURCES_DESCRIPTION,
TY.TYPES_DECRIPTION
--NT_CUSTOMERS.*,NT_STATUS_HISTORY_DATA.*,NT_REGIONS.*,NT_STATEREGION.*,NT_BROKER.*,NT_CATEGORIES.*,NT_PRIORITIES.*,
--NT_PRODUCTS.*,NT_SOURCES.*,NT_STATUSES.*,NT_TYPES.*
FROM NT_COMPLAINSDATA AS COMP
LEFT OUTER JOIN NT_CUSTOMERS CUST ON COMP.CD_CUSTOMERID = CUST.CUSTOMER_ID
LEFT OUTER JOIN NT_STATUS_HISTORY_DATA SHD ON COMP.CD_CUSTOMERID = SHD.SHD_ComplaintID
LEFT OUTER JOIN NT_REGIONS RG ON COMP.CD_CUSTOMERID = RG.REGION_ID
LEFT OUTER JOIN NT_STATEREGION SRG ON RG.STATE_CODE = SRG.R_STATE_CODE
LEFT OUTER JOIN NT_BROKER BR ON  COMP.CD_BROKERID = BR.BROKER_ID
LEFT OUTER JOIN NT_CATEGORIES CAT ON COMP.COMPLAINCATEGARYID = CAT.CATEGORIES_ID
LEFT OUTER JOIN NT_PRIORITIES PR ON COMP.CD_COMPLAINPRIORITYID = PR.PRIORITIES_ID
LEFT OUTER JOIN NT_PRODUCTS PRD ON COMP.CD_PRODUCTID = PRD.PRODUCT_ID
LEFT OUTER JOIN NT_SOURCES SRC ON COMP.CD_COMPLAINSOURCEID = SRC.SOURCES_ID
LEFT OUTER JOIN NT_STATUSES STS ON COMP.ComplainStatusID = STS.STATUS_ID
LEFT OUTER JOIN NT_TYPES TY ON COMP.CD_COMPLAINTYPEID = TY.TYPES_ID
;

SELECT DISTINCT * FROM NT_MASTER_COMADMINSTRATION;
DESCRIBE TABLE  NT_MASTER_COMADMINSTRATION;
SELECT * FROM  NT_MASTER_COMADMINSTRATION;
